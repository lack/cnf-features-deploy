---
apiVersion: ran.openshift.io/v1
kind: PolicyGenTemplate
metadata:
  name: "example-multinode-site"
  namespace: "ztp-site"
spec:
  bindingRules:
    sites: "example-multinode"
  mcp: "worker"
  sourceFiles:
    - fileName: KlusterletAddonConfig.yaml
      policyName: "" # Intentionally blank so it applies directly to the hub
      # Both sets of 'name' and 'clusterName', and 'namespace' and
      # 'clusterNamespace' must match the name and namespace of the
      # corresponding SiteConfig for this site:
      metadata:
        name: "example-sno"
        namespace: "example-sno"
      spec:
        clusterName: "example-sno"
        clusterNamespace: "example-sno"
    - fileName: SriovNetwork.yaml
      policyName: "config-policy"
      metadata:
        name: "sriov-nw-du-fh"
      spec:
        resourceName: du_fh
        vlan: 140
    - fileName: SriovNetworkNodePolicy.yaml
      policyName: "config-policy"
      metadata:
        name: "sriov-nnp-du-fh"
      spec:
        deviceType: netdevice
        isRdma: true
        nicSelector:
          pfNames: ["ens5f0"]
        numVfs: 8
        priority: 10
        resourceName: du_fh
    - fileName: SriovNetwork.yaml
      policyName: "config-policy"
      metadata:
        name: "sriov-nw-du-mh"
      spec:
        resourceName: du_mh
        vlan: 150
    - fileName: SriovNetworkNodePolicy.yaml
      policyName: "config-policy"
      metadata:
        name: "sriov-nnp-du-mh"
      spec:
        deviceType: vfio-pci
        isRdma: false
        nicSelector:
          pfNames: ["ens7f0"]
        numVfs: 8
        priority: 10
        resourceName: du_mh
